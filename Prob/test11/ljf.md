## 正义·伊兰翠(改)

### [问题背景]

吾之友人啊，听进那丝细语吧。 

我是《正义》，掌管《不公》。 

既是清白之法，亦是弹劾之剑。 

必须将所有邪恶之人斩草除根。

### [问题描述]

小M是正义的代言人，他的实验室里有 $n$ 个活细胞，他正在用这些细胞进行生命进化的研究：

这 $n$ 个细胞初始第 $i$ 个细胞活性系数为 $w_i$，且开始时连成一棵有边权的树。由于生命的演变具有随机性，现在 $n$ 个细胞将重新配对形成一棵全新的树。

每对细胞配对会令小M产生 $w_i+w_j+dis(i,j)$ 的快乐值，其中 $dis(i,j)$ 为原树上 $i$ 到 $j$ 的距离。

他想请你告诉他，他的快乐值最大可以为多少？

### [输入格式]

第一行一个整数 $n$

接下来一行 $n$ 个整数表示 $w_i$

接下来 $n-1$ 行，每行三个数 $u,v, w$ 表示原树上的一条边

### [输出格式]

一行一个整数表示答案

### [样例输入]

```c++
4
1 3 5 1
1 2 1
2 3 2
3 4 3
```

### [样例输出]

```c++
22
```

### [数据范围]

对于 $30\%$ 的数据，满足 $n \leq 1000$

对于 $100\%$ 的数据，满足 $n \leq 2\times 10^5$